<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using scatterplots to identify outliers • nipnTK</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using scatterplots to identify outliers">
<meta property="og:description" content="nipnTK">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-155098215-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-155098215-2');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nipnTK</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/nipnTK.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/rl.html">Check ranges and legal values</a>
    </li>
    <li>
      <a href="../articles/sp.html">Identify outliers using scatterplots</a>
    </li>
    <li>
      <a href="../articles/flagging.html">Identify outliers using flags</a>
    </li>
    <li>
      <a href="../articles/ad.html">Assess distributions of variables and indices</a>
    </li>
    <li>
      <a href="../articles/dp.html">Assess digit preference</a>
    </li>
    <li>
      <a href="../articles/ah.html">Assess age heaping</a>
    </li>
    <li>
      <a href="../articles/sr.html">Assess sex ratio</a>
    </li>
    <li>
      <a href="../articles/as.html">Assess age and sex distributions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://twitter.com/ernestguevarra">
    <span class="fab fa fab fa-twitter fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://www.linkedin.com/in/ernestguevarra/">
    <span class="fab fa fab fa-linkedin fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/nutriverse/nipnTK/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="sp_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Using scatterplots to identify outliers</h1>
                        <h4 class="author">Mark Myatt</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/nutriverse/nipnTK/blob/master/vignettes/sp.Rmd"><code>vignettes/sp.Rmd</code></a></small>
      <div class="hidden name"><code>sp.Rmd</code></div>

    </div>

    
    
<p>We can expect anthropometric variables in children to be strongly and positively associated with each other. This is because children tend to gain both weight and height as they grow. This allows us to use graphical and numeric methods to identify outliers (i.e. observations that are distant from most other observations) that may be due to errors.</p>
<p>It is important to note that anthropometric surveys often use a method of comparing observed values against reference values using a process known as “flagging” to identify and censor outliers. The methods outlined in this section are intended to complement rather than replace the “flagging”</p>
<div id="identifying-outliers-by-observation" class="section level2">
<h2 class="hasAnchor">
<a href="#identifying-outliers-by-observation" class="anchor"></a>Identifying outliers by observation</h2>
<p>We will use the dataset <code>sp.ex01</code>:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="no">svy</span> <span class="kw">&lt;-</span> <span class="no">sp.ex01</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">svy</span>)
<span class="co">#&gt;   age sex weight height muac oedema</span>
<span class="co">#&gt; 1  54   1   20.5  111.5  180      2</span>
<span class="co">#&gt; 2  53   1   19.3  108.0  167      2</span>
<span class="co">#&gt; 3  51   2   19.3  106.0  163      2</span>
<span class="co">#&gt; 4  44   1   18.9  111.0  163      2</span>
<span class="co">#&gt; 5  47   1   18.8  103.0  173      2</span>
<span class="co">#&gt; 6  48   2   18.6   95.3  171      1</span></pre></body></html></div>
<p>The dataset <code>sp.ex01</code> contains anthropometric data from a SMART survey from the Democratic Republic of Congo.</p>
<p>We will look at the relationship between height and weight in this dataset:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">svy</span>$<span class="no">height</span>, <span class="no">svy</span>$<span class="no">weight</span>)</pre></body></html></div>
<p>The resulting plot is shown below.</p>
<p><img src="sp_files/figure-html/unnamed-chunk-4-1.png" width="700" style="display: block; margin: auto;"></p>
<p>There is a clear positive linear relationship between height and weight (i.e. weight increases with increasing height along a straight line). We can assess the strength of this relationship using the Pearson correlation coefficient:</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span>(<span class="no">svy</span>$<span class="no">height</span>, <span class="no">svy</span>$<span class="no">weight</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"pearson"</span>, <span class="kw">use</span> <span class="kw">=</span> <span class="st">"complete.obs"</span>)</pre></body></html></div>
<p>which returns:</p>
<pre><code>#&gt; [1] 0.9204116</code></pre>
<p>This is very close to one, which indicates a perfect positive association. There are, however a few points that lie outside of the bulk of the plotted points. These outliers may be due to errors in the data.</p>
<p>The presence of oedema can be associated with increased weight. This is a particular issue with severe oedema. An outlier with a high value of weight for a given height could be due to oedema. We can check this:</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">svy</span>$<span class="no">height</span>, <span class="no">svy</span>$<span class="no">weight</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="no">svy</span>$<span class="no">oedema</span> <span class="kw">==</span> <span class="fl">1</span>, <span class="fl">19</span>, <span class="fl">1</span>))</pre></body></html></div>
<p>The <code>pch = ifelse(svy$oedema == 1, 19, 1)</code> tells the <code><a href="https://rdrr.io/r/base/plot.html">plot()</a></code> function to plot filled circles for oedema cases and open circles for children without oedema. The resulting plot is shown below.</p>
<p><img src="sp_files/figure-html/unnamed-chunk-8-1.png" width="700" style="display: block; margin: auto;"></p>
<p>A single high weight for height outlier appears to be due to the presence of oedema.</p>
<p>The other filled circles that are located in the main mass of plotted points show that children with oedema may have a body weight within the normal range for their height. These children may not be not wasted but they are suffering from a form of severe acute malnutrition (SAM) known as <em>kwashiorkor</em>.</p>
<p>Outliers can be identified by eye. The <code><a href="https://rdrr.io/r/graphics/identify.html">identify()</a></code> function can help with this:</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">svy</span>$<span class="no">height</span>, <span class="no">svy</span>$<span class="no">weight</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="no">svy</span>$<span class="no">oedema</span> <span class="kw">==</span> <span class="fl">1</span>, <span class="fl">19</span>, <span class="fl">1</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/identify.html">identify</a></span>(<span class="no">svy</span>$<span class="no">height</span>, <span class="no">svy</span>$<span class="no">weight</span>)</pre></body></html></div>
<p>Clicking on any point will cause the record (row) number associated with each point to be displayed on the plot (as shown below).</p>
<p><img src="sp_files/figure-html/unnamed-chunk-10-1.png" width="700" style="display: block; margin: auto;"></p>
<p>Right-clicking on the plot or pressing the “escape” key will stop <code><a href="https://rdrr.io/r/graphics/identify.html">identify()</a></code>.</p>
<p>The behaviour of the <code><a href="https://rdrr.io/r/graphics/identify.html">identify()</a></code> function may be different when you use an alternative user interface for R such as <em>RStudio</em> or <em>RAnalyticFlow</em>.</p>
<p>The <code><a href="https://rdrr.io/r/graphics/identify.html">identify()</a></code> function will, by default, display record (row) numbers for identified points. This is usually what is needed. Alternative labels can be displayed. For example:</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">svy</span>$<span class="no">height</span>, <span class="no">svy</span>$<span class="no">weight</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="no">svy</span>$<span class="no">oedema</span> <span class="kw">==</span> <span class="fl">1</span>, <span class="fl">19</span>, <span class="fl">1</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/identify.html">identify</a></span>(<span class="no">svy</span>$<span class="no">height</span>, <span class="no">svy</span>$<span class="no">weight</span>,
         <span class="kw">labels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="no">svy</span>$<span class="no">height</span>, <span class="no">svy</span>$<span class="no">weight</span>, <span class="kw">sep</span> <span class="kw">=</span> <span class="st">";"</span>),
         <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">0.75</span>)</pre></body></html></div>
<p>displays the height and weight values at selected points.</p>
<p>The ability to display custom labels is useful if there is a variable (column) in a dataset that contains unique record identifiers.</p>
<p>It is useful to be able to store the record (row) numbers of identified points:</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">svy</span>$<span class="no">height</span>, <span class="no">svy</span>$<span class="no">weight</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="no">svy</span>$<span class="no">oedema</span> <span class="kw">==</span> <span class="fl">1</span>, <span class="fl">19</span>, <span class="fl">1</span>))
<span class="no">stored</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/identify.html">identify</a></span>(<span class="no">svy</span>$<span class="no">height</span>, <span class="no">svy</span>$<span class="no">weight</span>)</pre></body></html></div>
<p>If the same points shown in the previous figure are clicked to identify them then:</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">stored</span></pre></body></html></div>
<p>will return:</p>
<pre><code>#&gt; [1] "1"  "6"  "16" "62" "66"</code></pre>
<p>We can examine the data for the identified points:</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">svy</span>[<span class="no">stored</span>, ]</pre></body></html></div>
<p>This returns:</p>
<pre><code>#&gt;    age sex weight height muac oedema
#&gt; 1   54   1   20.5  111.5  180      2
#&gt; 6   48   2   18.6   95.3  171      1
#&gt; 16  30   1   16.9   92.5  188      2
#&gt; 62  55   1   15.1  118.0  156      2
#&gt; 66  56   1   15.0  115.0  148      2</code></pre>
<p>The <strong>oedema</strong> data is coded <strong>1</strong> for present and <strong>2</strong> for absent.</p>
<p>Data can be checked and edited if needed. Note that record <strong>6</strong> is an oedema case and should probably be left alone.</p>
<p>If your dataset has many variables (columns) then you may specify only the variables (columns) of interest:</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="no">svy</span>[<span class="no">stored</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"weight"</span>, <span class="st">"height"</span>, <span class="st">"oedema"</span>)]</pre></body></html></div>
<p>This returns:</p>
<pre><code>#&gt;    weight height oedema
#&gt; 1    20.5  111.5      2
#&gt; 6    18.6   95.3      1
#&gt; 16   16.9   92.5      2
#&gt; 62   15.1  118.0      2
#&gt; 66   15.0  115.0      2</code></pre>
</div>
<div id="identifying-outliers-using-statistical-distance" class="section level2">
<h2 class="hasAnchor">
<a href="#identifying-outliers-using-statistical-distance" class="anchor"></a>Identifying outliers using statistical distance</h2>
<p>A more formal method of identifying outliers is to use a measure of the statistical distance. A common measure of <em>statistical distance</em> that is applied to scatterplot data is the <em>Mahalanobis distance</em>. This treats the bivariate probability distribution as an ellipsoid. The Mahalanobis distance is the distance of a point from the centre of mass of the distribution divided by width of the ellipsoid in the direction of the point:</p>
<p><img src="../man/figures/mahalanobis.png" width="462" style="display: block; margin: auto;"></p>
<p>In directions in which the ellipsoid has a short axis the test point must be close to the centre of mass of the distribution. In directions in which the ellipsoid has a long axis the test point may be more distant from the centre of mass of the distribution.</p>
<p>The NiPN data quality toolkit provides an <em>R</em> language function <code><a href="../reference/outliersMD.html">outliersMD()</a></code> that uses the Mahalanobis distance to identify outliers in the same dataset:</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="no">svy</span>[<span class="fu"><a href="../reference/outliersMD.html">outliersMD</a></span>(<span class="no">svy</span>$<span class="no">height</span>, <span class="no">svy</span>$<span class="no">weight</span>), ]</pre></body></html></div>
<p>This returns the same set of records that was identified by eye:</p>
<pre><code>#&gt;    age sex weight height muac oedema
#&gt; 1   54   1   20.5  111.5  180      2
#&gt; 6   48   2   18.6   95.3  171      1
#&gt; 16  30   1   16.9   92.5  188      2
#&gt; 62  55   1   15.1  118.0  156      2
#&gt; 66  56   1   15.0  115.0  148      2</code></pre>
<p>Data can be checked and edited if needed. Note that record <strong>6</strong> is an oedema case and should probably be left alone.</p>
<p>We can use the <code><a href="../reference/outliersMD.html">outliersMD()</a></code> to identify and display outliers on a scatterplot:</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">svy</span>$<span class="no">height</span>, <span class="no">svy</span>$<span class="no">weight</span>,
<span class="kw">pch</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="fu"><a href="../reference/outliersMD.html">outliersMD</a></span>(<span class="no">svy</span>$<span class="no">height</span>, <span class="no">svy</span>$<span class="no">weight</span>), <span class="fl">19</span>, <span class="fl">1</span>))</pre></body></html></div>
<p><img src="sp_files/figure-html/unnamed-chunk-22-1.png" width="700" style="display: block; margin: auto;"></p>
<p>The <code><a href="../reference/outliersMD.html">outliersMD()</a></code> function has an <strong>alpha</strong> parameter. The default value for the <strong>alpha</strong> parameter is <code>alpha = 0.001</code>. This value is used automatically unless another value is specified.</p>
<p>When we use <code>alpha = 0.001</code> we are looking for records with values so extreme that we would expect to find them with a probability of 0.001 when there are no problems with the data.</p>
<p>We can calculate the number of outliers that we expect to see by chance with <code>alpha = 0.001</code> using:</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">svy</span>) * <span class="fl">0.001</span>)</pre></body></html></div>
<p>This returns:</p>
<pre><code>#&gt; [1] 1</code></pre>
<p>We found five potential outliers. The difference between the number that we expected and the number that we observed (i.e. one expected vs. five observed) suggests that some of the identified outliers are true outliers or due to data errors.</p>
<p>Another way of looking at the <strong>alpha</strong> parameter is that it alters the sensitivity of the <code>outlierMD()</code> function for detecting outliers by altering the threshold distance that is used to define outliers. This can be useful when using the <code>outlierMD()</code> function with some, but not all, curvilinear relationships (see below).</p>
<p>Larger values of <strong>alpha</strong> will tend to detect more potential outliers. For example:</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">svy</span>$<span class="no">height</span>, <span class="no">svy</span>$<span class="no">weight</span>,
     <span class="kw">pch</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="fu"><a href="../reference/outliersMD.html">outliersMD</a></span>(<span class="no">svy</span>$<span class="no">height</span>, <span class="no">svy</span>$<span class="no">weight</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.01</span>), <span class="fl">19</span>, <span class="fl">1</span>))</pre></body></html></div>
<p><img src="sp_files/figure-html/unnamed-chunk-25-1.png" width="700" style="display: block; margin: auto;"></p>
<p>and:</p>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="no">svy</span>[<span class="fu"><a href="../reference/outliersMD.html">outliersMD</a></span>(<span class="no">svy</span>$<span class="no">height</span>,<span class="no">svy</span>$<span class="no">weight</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.01</span>), ]
<span class="co">#&gt;     age sex weight height muac oedema</span>
<span class="co">#&gt; 1    54   1   20.5  111.5  180      2</span>
<span class="co">#&gt; 2    53   1   19.3  108.0  167      2</span>
<span class="co">#&gt; 3    51   2   19.3  106.0  163      2</span>
<span class="co">#&gt; 4    44   1   18.9  111.0  163      2</span>
<span class="co">#&gt; 5    47   1   18.8  103.0  173      2</span>
<span class="co">#&gt; 6    48   2   18.6   95.3  171      1</span>
<span class="co">#&gt; 16   30   1   16.9   92.5  188      2</span>
<span class="co">#&gt; 32   43   1   16.2   92.6  166      2</span>
<span class="co">#&gt; 61   26   1   15.1   87.6  168      2</span>
<span class="co">#&gt; 62   55   1   15.1  118.0  156      2</span>
<span class="co">#&gt; 66   56   1   15.0  115.0  148      2</span>
<span class="co">#&gt; 477  38   2   10.3   94.6  160      2</span>
<span class="co">#&gt; 487  32   2   10.2   93.0  150      2</span>
<span class="co">#&gt; 722  17   2    8.6   63.3  136      2</span></pre></body></html></div>
<p>In almost all cases the default <strong>alpha = 0.001</strong> will be appropriate.</p>
<p>The techniques outlined above can be used to examine the relationships between other pairs of anthropometric variables (e.g. <strong>weight</strong> and <strong>muac</strong>) and to identify outliers. All sensible pairings of variables should be examined.</p>
</div>
<div id="anthropometric-measurements-and-age" class="section level2">
<h2 class="hasAnchor">
<a href="#anthropometric-measurements-and-age" class="anchor"></a>Anthropometric measurements and age</h2>
<p>We also expect anthropometric variables to be associated with age. This relationship is particularly strong in children. It will be less strong in adults and may be weak or even reversed in older people.</p>
<p>We can explore the relationship between an anthropometric variable and age using the techniques described above. For example:</p>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">svy</span>$<span class="no">age</span>, <span class="no">svy</span>$<span class="no">height</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="fu"><a href="../reference/outliersMD.html">outliersMD</a></span>(<span class="no">svy</span>$<span class="no">age</span>, <span class="no">svy</span>$<span class="no">height</span>), <span class="fl">19</span>, <span class="fl">1</span>))
<span class="no">svy</span>[<span class="fu"><a href="../reference/outliersMD.html">outliersMD</a></span>(<span class="no">svy</span>$<span class="no">age</span>, <span class="no">svy</span>$<span class="no">height</span>), ]</pre></body></html></div>
<p><img src="sp_files/figure-html/unnamed-chunk-28-1.png" width="700" style="display: block; margin: auto;"></p>
<pre><code>#&gt;    age sex weight height muac oedema
#&gt; 4   44   1   18.9    111  163      2
#&gt; 62  55   1   15.1    118  156      2</code></pre>
<p>There are some problems with this approach. Age is often reported and recorded with considerable age heaping. Age is unlikely to be approximately normally distributed, which is an assumption of the Mahalanobis distance method. The relationship between anthropometric variables and age usually follows a “growth curve” rather than a straight line.</p>
<p>The combination of age heaping, non-normality, and a curvilinear relationship may reduce the effectiveness of the Mahalanobis distance method for detecting outliers. It may be useful, in such cases, to increase the value of the <strong>alpha</strong> parameter. For example:</p>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">svy</span>$<span class="no">age</span>, <span class="no">svy</span>$<span class="no">height</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="fu"><a href="../reference/outliersMD.html">outliersMD</a></span>(<span class="no">svy</span>$<span class="no">age</span>, <span class="no">svy</span>$<span class="no">height</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.025</span>), <span class="fl">19</span>, <span class="fl">1</span>))</pre></body></html></div>
<p><img src="sp_files/figure-html/unnamed-chunk-29-1.png" width="700" style="display: block; margin: auto;"></p>
<p>Outliers can be listed using the same value for <strong>alpha</strong>:</p>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="no">svy</span>[<span class="fu"><a href="../reference/outliersMD.html">outliersMD</a></span>(<span class="no">svy</span>$<span class="no">age</span>, <span class="no">svy</span>$<span class="no">height</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.025</span>), ]
<span class="co">#&gt;     age sex weight height muac oedema</span>
<span class="co">#&gt; 1    54   1   20.5  111.5  180      2</span>
<span class="co">#&gt; 4    44   1   18.9  111.0  163      2</span>
<span class="co">#&gt; 7    55   1   18.6  109.3  156      2</span>
<span class="co">#&gt; 14   48   1   17.0  109.0  175      2</span>
<span class="co">#&gt; 27   56   2   16.4  110.0  149      2</span>
<span class="co">#&gt; 62   55   1   15.1  118.0  156      2</span>
<span class="co">#&gt; 66   56   1   15.0  115.0  148      2</span>
<span class="co">#&gt; 113  58   1   14.2   92.0  148      2</span>
<span class="co">#&gt; 129  23   2   14.0   95.0  161      2</span>
<span class="co">#&gt; 190  15   2   13.0   90.5  150      2</span>
<span class="co">#&gt; 212  21   2   12.8   93.0  152      2</span>
<span class="co">#&gt; 378  51   2   11.2   83.0  141      2</span>
<span class="co">#&gt; 453  49   1   10.6   83.0  139      2</span>
<span class="co">#&gt; 461  54   2   10.5   86.8  132      2</span>
<span class="co">#&gt; 551  41   2    9.8   78.0  139      2</span>
<span class="co">#&gt; 599  50   1    9.5   84.7  123      2</span>
<span class="co">#&gt; 660  49   1    9.1   79.5  129      2</span>
<span class="co">#&gt; 722  17   2    8.6   63.3  136      2</span>
<span class="co">#&gt; 809  41   2    7.9   75.7  120      2</span>
<span class="co">#&gt; 881  30   1    6.5   69.6  103      2</span>
<span class="co">#&gt; 893  18   2    5.8   63.2  106      2</span></pre></body></html></div>
<p>The Mahalanobis distance method is usually robust enough to deal with age data provided an appropriate value for <strong>alpha</strong> is used.</p>
</div>
<div id="difficult-relationships-for-the-mahalanobis-distance-method" class="section level2">
<h2 class="hasAnchor">
<a href="#difficult-relationships-for-the-mahalanobis-distance-method" class="anchor"></a>Difficult relationships for the Mahalanobis distance method</h2>
<p>The Mahalanobis distance method works well with pairs of variables as long as the relationship between the two variables is <em>monotonic</em> (i.e. one variables always increases or always decreases in value as the other variable increases in value). This is usually the case with anthropometric data.</p>
<p>We will explore the use of the Mahalanobis distance method with data that is not monotonic using generated data:</p>
<div class="sourceCode" id="cb26"><html><body><pre class="r"><span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>, <span class="fl">8</span>, <span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">22</span>, <span class="fl">27</span>, <span class="fl">38</span>, <span class="fl">40</span>, <span class="fl">47</span>, <span class="fl">48</span>, <span class="fl">53</span>, <span class="fl">55</span>, <span class="fl">63</span>, <span class="fl">71</span>, <span class="fl">76</span>, <span class="fl">85</span>, <span class="fl">92</span>, <span class="fl">96</span>)
<span class="no">y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">6</span>, <span class="fl">22</span>, <span class="fl">34</span>, <span class="fl">42</span>, <span class="fl">51</span>, <span class="fl">59</span>, <span class="fl">64</span>, <span class="fl">69</span>, <span class="fl">70</span>, <span class="fl">20</span>, <span class="fl">70</span>, <span class="fl">63</span>, <span class="fl">63</span>, <span class="fl">55</span>, <span class="fl">46</span>, <span class="fl">33</span>, <span class="fl">19</span>, <span class="fl">6</span>)
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">x</span>, <span class="no">y</span>)</pre></body></html></div>
<p><img src="sp_files/figure-html/unnamed-chunk-31-1.png" width="700" style="display: block; margin: auto;"></p>
<p>There is a clear relationship between <strong>x</strong> and <strong>y</strong> but it is <strong>not</strong> a monotonic relationship (i.e. it is not always increasing or decreasing). There is a single obvious outlier. The Mahalanobis distance method will <strong>not</strong> work well with this data. This:</p>
<div class="sourceCode" id="cb27"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">x</span>, <span class="no">y</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="fu"><a href="../reference/outliersMD.html">outliersMD</a></span>(<span class="no">x</span>, <span class="no">y</span>), <span class="fl">19</span>, <span class="fl">1</span>))</pre></body></html></div>
<p><img src="sp_files/figure-html/unnamed-chunk-32-1.png" width="700" style="display: block; margin: auto;"></p>
<p>fails to detect the outlier. Relaxing the alpha parameter:</p>
<div class="sourceCode" id="cb28"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">x</span>, <span class="no">y</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="fu"><a href="../reference/outliersMD.html">outliersMD</a></span>(<span class="no">x</span>, <span class="no">y</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.025</span>), <span class="fl">19</span>, <span class="fl">1</span>))</pre></body></html></div>
<p>does not help. Relaxing the alpha parameter further:</p>
<div class="sourceCode" id="cb29"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">x</span>, <span class="no">y</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="fu"><a href="../reference/outliersMD.html">outliersMD</a></span>(<span class="no">x</span>, <span class="no">y</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.1</span>), <span class="fl">19</span>, <span class="fl">1</span>))</pre></body></html></div>
<p><img src="sp_files/figure-html/unnamed-chunk-34-1.png" width="700" style="display: block; margin: auto;"></p>
<p>results in false positive results but fails to identify the clear outlier.</p>
<p>Although Mahalanobis distance cannot be used directly to identify outliers in non-monotonic relationships, it can be applied to residuals from fitted non-linear models. This technique is unlikely to be required with anthropometric data and is not covered in this toolkit.</p>
<p>It is very unlikely that you will see non-monotonic relationships with anthropometric data. You are likely to see “growth curves” that look like this:</p>
<div class="sourceCode" id="cb30"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">0</span>)
<span class="no">x</span> <span class="kw">&lt;-</span> <span class="fl">0</span>:<span class="fl">100</span>
<span class="no">y</span> <span class="kw">&lt;-</span> <span class="fl">1</span> - <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(-<span class="no">x</span> / <span class="fl">50</span>) + <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">101</span>, <span class="fl">0</span>, <span class="fl">0.05</span>)
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">x</span>, <span class="no">y</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">x</span>, <span class="fl">1</span> - <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(-<span class="no">x</span> / <span class="fl">50</span>), <span class="kw">lty</span> <span class="kw">=</span> <span class="fl">2</span>)</pre></body></html></div>
<p><img src="sp_files/figure-html/unnamed-chunk-35-1.png" width="700" style="display: block; margin: auto;"></p>
<p>This is a monotonic relationship. The Mahalanobis distance method should work well with this data. If we add a clear outlier:</p>
<div class="sourceCode" id="cb31"><html><body><pre class="r"><span class="no">y</span>[<span class="fl">50</span>] <span class="kw">&lt;-</span> <span class="fl">0.3</span>
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">x</span>, <span class="no">y</span>)</pre></body></html></div>
<p><img src="sp_files/figure-html/unnamed-chunk-36-1.png" width="700" style="display: block; margin: auto;"></p>
<p>this can be detected using the Mahalanobis distance method using a slightly relaxed alpha value:</p>
<div class="sourceCode" id="cb32"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">x</span>, <span class="no">y</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="fu"><a href="../reference/outliersMD.html">outliersMD</a></span>(<span class="no">x</span>, <span class="no">y</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.005</span>), <span class="fl">19</span>, <span class="fl">1</span>))</pre></body></html></div>
<p><img src="sp_files/figure-html/unnamed-chunk-37-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div id="working-with-data-from-older-children" class="section level2">
<h2 class="hasAnchor">
<a href="#working-with-data-from-older-children" class="anchor"></a>Working with data from older children</h2>
<p>We will now look at using scatterplots and Mahalanobis distance methods with data from older children.</p>
<p>We will use the <code>sp.ex02</code> dataset:</p>
<div class="sourceCode" id="cb33"><html><body><pre class="r"><span class="no">svy</span> <span class="kw">&lt;-</span> <span class="no">sp.ex02</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">svy</span>)
<span class="co">#&gt;   region school ageMonths sex weight height   haz   waz   baz</span>
<span class="co">#&gt; 1      1      1        64   1   13.9   97.7 -3.12 -2.56 -0.56</span>
<span class="co">#&gt; 2      1      1        72   1   21.1  118.7  0.56  0.21 -0.25</span>
<span class="co">#&gt; 3      1      1        75   2   15.6  103.7 -2.47 -2.02 -0.53</span>
<span class="co">#&gt; 4      1      1        75   2   16.0  102.7 -2.66 -1.82 -0.08</span>
<span class="co">#&gt; 5      1      1        75   2   17.5  108.7 -1.51 -1.16 -0.31</span>
<span class="co">#&gt; 6      1      1        79   1   15.0  101.0 -3.57 -2.99 -0.53</span></pre></body></html></div>
<p>The dataset <code>sp.ex02</code> contains anthropometric data from a survey of school-age (i.e. between 5 and 15 years) children from Pakistan.</p>
<p>We can summarise the dataset using:</p>
<div class="sourceCode" id="cb34"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">svy</span>)</pre></body></html></div>
<p>This returns:</p>
<pre><code>#&gt;      region          school        ageMonths          sex       
#&gt;  Min.   :1.000   Min.   : 1.00   Min.   : 60.0   Min.   :1.000  
#&gt;  1st Qu.:3.000   1st Qu.: 8.00   1st Qu.: 83.0   1st Qu.:1.000  
#&gt;  Median :4.000   Median :15.00   Median : 98.0   Median :1.000  
#&gt;  Mean   :4.491   Mean   :15.51   Mean   :104.8   Mean   :1.397  
#&gt;  3rd Qu.:7.000   3rd Qu.:23.00   3rd Qu.:124.0   3rd Qu.:2.000  
#&gt;  Max.   :8.000   Max.   :30.00   Max.   :178.0   Max.   :2.000  
#&gt;                                                                 
#&gt;      weight          height           haz              waz        
#&gt;  Min.   :10.30   Min.   : 86.2   Min.   :-5.730   Min.   :-5.350  
#&gt;  1st Qu.:17.20   1st Qu.:108.7   1st Qu.:-2.640   1st Qu.:-2.380  
#&gt;  Median :21.30   Median :120.9   Median :-1.790   Median :-1.615  
#&gt;  Mean   :22.62   Mean   :121.2   Mean   :-1.705   Mean   :-1.581  
#&gt;  3rd Qu.:27.00   3rd Qu.:132.6   3rd Qu.:-0.790   3rd Qu.:-0.805  
#&gt;  Max.   :51.90   Max.   :164.2   Max.   : 3.550   Max.   : 3.010  
#&gt;                                                   NA's   :267     
#&gt;       baz         
#&gt;  Min.   :-4.7000  
#&gt;  1st Qu.:-1.2900  
#&gt;  Median :-0.7600  
#&gt;  Mean   :-0.7758  
#&gt;  3rd Qu.:-0.2100  
#&gt;  Max.   : 1.9900  
#&gt;  NA's   :8</code></pre>
<p>The <strong>baz</strong> variable contains the BMI-for-age z-score calculated from the <strong>ageMonths</strong>, <strong>sex</strong>, <strong>weight</strong>, and <strong>height</strong> variables using the WHO growth reference. A key thing to notice in the summary is the large number of missing values in the <strong>waz</strong> variable. This is because the weight-for-age z-score is not calculated for children aged older than 120 months. You can check this using:</p>
<div class="sourceCode" id="cb36"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/by.html">by</a></span>(<span class="no">svy</span>$<span class="no">ageMonths</span>, <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">svy</span>$<span class="no">waz</span>), <span class="no">summary</span>)</pre></body></html></div>
<p>This gives:</p>
<pre><code>#&gt; is.na(svy$waz): FALSE
#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#&gt;   60.00   76.00   88.00   88.24   99.00  120.00 
#&gt; ------------------------------------------------------------ 
#&gt; is.na(svy$waz): TRUE
#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#&gt;   121.0   125.5   141.0   140.8   151.0   178.0</code></pre>
<p>There appears to be nothing odd about the large number of missing values in the <strong>waz</strong> variable.</p>
<p>We should investigate the missing values in the <strong>baz</strong> variable:</p>
<div class="sourceCode" id="cb38"><html><body><pre class="r"><span class="no">svy</span>[<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">svy</span>$<span class="no">baz</span>), ]</pre></body></html></div>
<p>This returns:</p>
<pre><code>#&gt;     region school ageMonths sex weight height   haz   waz baz
#&gt; 83       1      3       143   2   14.0  125.9 -3.64    NA  NA
#&gt; 158      2      6        96   1   12.3  118.4 -1.57 -5.26  NA
#&gt; 275      3     10        77   1   10.3  113.9 -0.88 -5.35  NA
#&gt; 415      4     15        75   1   33.0  108.3 -1.90  3.01  NA
#&gt; 508      5     19        85   2   11.1  111.5 -1.78 -4.84  NA
#&gt; 529      6     20        78   1   12.1  111.9 -1.37 -4.45  NA
#&gt; 761      8     28        62   1   13.3  115.4  0.99 -2.70  NA
#&gt; 806      8     29       100   1   13.2  121.2 -1.36 -5.01  NA</code></pre>
<p>The data required to calculate the BMI-for-age z-score are present. Given the extreme values in the <strong>waz</strong> variable it is likely that the BMI-for-age z-scores in these records were calculated, found to be outside of the upper and lower flagging criteria, and the value for <strong>baz</strong> set to missing. We should check this and recalculate the BMI-for-age z-scores.</p>
<p>We can use scatterplots to examine the relationship between <strong>ageMonths</strong>, <strong>weight</strong>, and <strong>height</strong>:</p>
<div class="sourceCode" id="cb40"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">svy</span>$<span class="no">ageMonths</span>, <span class="no">svy</span>$<span class="no">weight</span>)</pre></body></html></div>
<p><img src="sp_files/figure-html/unnamed-chunk-45-1.png" width="700" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb41"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">svy</span>$<span class="no">ageMonths</span>, <span class="no">svy</span>$<span class="no">height</span>)</pre></body></html></div>
<p><img src="sp_files/figure-html/unnamed-chunk-45-2.png" width="700" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb42"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">svy</span>$<span class="no">height</span>, <span class="no">svy</span>$<span class="no">weight</span>)</pre></body></html></div>
<p><img src="sp_files/figure-html/unnamed-chunk-45-3.png" width="700" style="display: block; margin: auto;"></p>
<p>These relationships are not as simple as in younger children:</p>
<p>Variability in <strong>weight</strong> appears to increase with increasing <strong>ageMonths</strong>.</p>
<p>The relationship between <strong>height</strong> and <strong>ageMonths</strong> may not be entirely linear.</p>
<p>The relationship between <strong>weight</strong> and <strong>height</strong> is clearly non-linear.</p>
<p>All of these relationships are monotonic so we should still be able to use the Mahalanobis distance method to identify outliers:</p>
<div class="sourceCode" id="cb43"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">svy</span>$<span class="no">ageMonths</span>, <span class="no">svy</span>$<span class="no">weight</span>,
     <span class="kw">pch</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="fu"><a href="../reference/outliersMD.html">outliersMD</a></span>(<span class="no">svy</span>$<span class="no">ageMonths</span>, <span class="no">svy</span>$<span class="no">weight</span>), <span class="fl">19</span>, <span class="fl">1</span>))</pre></body></html></div>
<p><img src="sp_files/figure-html/unnamed-chunk-46-1.png" width="700" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb44"><html><body><pre class="r">
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">svy</span>$<span class="no">ageMonths</span>, <span class="no">svy</span>$<span class="no">height</span>,
     <span class="kw">pch</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="fu"><a href="../reference/outliersMD.html">outliersMD</a></span>(<span class="no">svy</span>$<span class="no">ageMonths</span>, <span class="no">svy</span>$<span class="no">height</span>), <span class="fl">19</span>, <span class="fl">1</span>))</pre></body></html></div>
<p><img src="sp_files/figure-html/unnamed-chunk-46-2.png" width="700" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb45"><html><body><pre class="r">
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">svy</span>$<span class="no">height</span>, <span class="no">svy</span>$<span class="no">weight</span>,
     <span class="kw">pch</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="fu"><a href="../reference/outliersMD.html">outliersMD</a></span>(<span class="no">svy</span>$<span class="no">height</span>, <span class="no">svy</span>$<span class="no">weight</span>), <span class="fl">19</span>, <span class="fl">1</span>))</pre></body></html></div>
<p><img src="sp_files/figure-html/unnamed-chunk-46-3.png" width="700" style="display: block; margin: auto;"></p>
<p>You may want to experiment with different values of the <strong>alpha</strong> parameter of the <code><a href="../reference/outliersMD.html">outliersMD()</a></code> function as described above. Records containing values identified as outliers can be listed:</p>
<div class="sourceCode" id="cb46"><html><body><pre class="r"><span class="no">svy</span>[<span class="fu"><a href="../reference/outliersMD.html">outliersMD</a></span>(<span class="no">svy</span>$<span class="no">ageMonths</span>, <span class="no">svy</span>$<span class="no">weight</span>), ]
<span class="co">#&gt;     region school ageMonths sex weight height   haz  waz   baz</span>
<span class="co">#&gt; 57       1      2       161   1   47.0  158.7 -0.05   NA  0.05</span>
<span class="co">#&gt; 83       1      3       143   2   14.0  125.9 -3.64   NA    NA</span>
<span class="co">#&gt; 139      2      5       123   2   46.5  144.9  0.64   NA  1.82</span>
<span class="co">#&gt; 319      3     11       143   1   45.2  156.0  1.06   NA  0.50</span>
<span class="co">#&gt; 407      4     14       132   1   46.2  155.3  1.73   NA  0.97</span>
<span class="co">#&gt; 415      4     15        75   1   33.0  108.3 -1.90 3.01    NA</span>
<span class="co">#&gt; 672      7     24       175   1   50.5  163.5 -0.42   NA -0.25</span>
<span class="co">#&gt; 727      7     26       147   1   46.1  162.7  1.67   NA -0.14</span>
<span class="co">#&gt; 731      7     26       173   1   51.9  164.2 -0.21   NA -0.03</span>
<span class="no">svy</span>[<span class="fu"><a href="../reference/outliersMD.html">outliersMD</a></span>(<span class="no">svy</span>$<span class="no">ageMonths</span>, <span class="no">svy</span>$<span class="no">height</span>), ]
<span class="co">#&gt;     region school ageMonths sex weight height  haz  waz   baz</span>
<span class="co">#&gt; 457      5     17       110   1   37.5    155 3.55 1.62 -0.32</span>
<span class="no">svy</span>[<span class="fu"><a href="../reference/outliersMD.html">outliersMD</a></span>(<span class="no">svy</span>$<span class="no">weight</span>, <span class="no">svy</span>$<span class="no">height</span>), ]
<span class="co">#&gt;     region school ageMonths sex weight height   haz   waz   baz</span>
<span class="co">#&gt; 57       1      2       161   1   47.0  158.7 -0.05    NA  0.05</span>
<span class="co">#&gt; 83       1      3       143   2   14.0  125.9 -3.64    NA    NA</span>
<span class="co">#&gt; 139      2      5       123   2   46.5  144.9  0.64    NA  1.82</span>
<span class="co">#&gt; 275      3     10        77   1   10.3  113.9 -0.88 -5.35    NA</span>
<span class="co">#&gt; 319      3     11       143   1   45.2  156.0  1.06    NA  0.50</span>
<span class="co">#&gt; 322      3     11       155   2   39.0  135.5 -3.01    NA  0.84</span>
<span class="co">#&gt; 369      4     13       118   2   35.5  129.7 -1.32  0.66  1.66</span>
<span class="co">#&gt; 407      4     14       132   1   46.2  155.3  1.73    NA  0.97</span>
<span class="co">#&gt; 415      4     15        75   1   33.0  108.3 -1.90  3.01    NA</span>
<span class="co">#&gt; 438      4     15       163   2   39.0  138.3 -2.92    NA  0.41</span>
<span class="co">#&gt; 611      6     22       148   1   41.9  146.5 -0.66    NA  0.75</span>
<span class="co">#&gt; 672      7     24       175   1   50.5  163.5 -0.42    NA -0.25</span>
<span class="co">#&gt; 731      7     26       173   1   51.9  164.2 -0.21    NA -0.03</span>
<span class="co">#&gt; 806      8     29       100   1   13.2  121.2 -1.36 -5.01    NA</span></pre></body></html></div>
<p>These records can be checked, edited (if required), and anthropometric indices recalculated.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Mark Myatt, Ernest Guevarra.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
